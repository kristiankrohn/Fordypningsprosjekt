from sklearn import datasets, neighbors
import numpy as np
import matplotlib.pyplot as plt
from sklearn.multiclass import OneVsRestClassifier
from sklearn.svm import LinearSVC
from sklearn import svm
from sklearn.cluster import KMeans
from sklearn.externals import joblib #in order to store the svm


file = open('data.txt', 'r')
convertedDataSet = [[]]
AllData = file.read()
DataSet = []
DataSetLabels = [] #r1 = 0, u1 = 1, l1 = 2, d1 = 3, c1 = 4
DataSet = AllData.split(':')
#print(DataSet)
for i in range(len(DataSet)):

    feature = []
    feature = DataSet[i].split(',')
    featuretype = feature[0]
    feature.pop(0)
    convertedDataSet.append(map(float, feature))

    if featuretype == 'r1':
        DataSetLabels.append(0)
    if featuretype == 'u1':
        DataSetLabels.append(1)
    if featuretype == 'l1':
        DataSetLabels.append(2)
    if featuretype == 'd1':
        DataSetLabels.append(3)
    if featuretype == 'c1':
        DataSetLabels.append(4)

    #pops the two empty lists at index 0 and end-index
    if i == (len(DataSet) - 1):
        convertedDataSet.pop(0)
        convertedDataSet.pop(len(DataSet) -1)
        #print(convertedDataSet)

print(DataSetLabels)
X = np.array(convertedDataSet)

Y = np.array(map(float, DataSetLabels))

clf = joblib.load('machinestate.pkl')#loads the machine-learning state

clf.fit(X,Y)
joblib.dump(clf, 'machineState.pkl')#saves the machine-learning state
print(clf.predict([[

                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1,

                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    3,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    4,
                    2,
                    1,
                    2,
                    3,
                    4,
                    5,
                    4,
                    3,
                    2,
                    5,
                    2,
                    3,
                    5,
                    1]]))
